# Mac Build Guide: Generating AAB for Aunnop

This guide outlines the collaborative process to update Aunnop's existing app (`com.Jobs4Dent.Jobs4Dent2`) on the Google Play Store.

**The Workflow:**
1.  **Aunnop (Windows)**: Generates the strict signing keys and sends them to you.
2.  **You (Mac)**: Use those keys to build Version 2 of the app.
3.  **You (Mac)**: Send the AAB file back to Aunnop for upload.

---

## ðŸ–¥ Part 1: Aunnop's Tasks (On Windows Laptop)

**Goal**: Generate the official upload keystore that belongs to Aunnop's Google Play account.

### 1.1. Open Command Prompt / PowerShell
Aunnop needs to open a terminal and navigate to the `android/app/` folder (where he wants to save the key).

```powershell
cd android/app
```

### 1.2. Run the Key Generation Command
Aunnop must copy and paste this **EXACT** command:

```powershell
keytool -genkey -v -keystore upload-keystore.jks -storetype JKS -keyalg RSA -keysize 2048 -validity 10000 -alias upload
```

### 1.3. Fill in the Details
*   **Password**: Creates a password (e.g., `12345678`). **IMPORTANT**: He must remember this.
*   **Certificate Info**: Answer the questions (Name, Org, City, etc.).

### 1.4. Send Files to Mac User
Aunnop must send **TWO** things to you:
1.  The file: `upload-keystore.jks`
2.  The password he created.

---

## ðŸ’» Part 2: Your Tasks (On Mac)

**Goal**: Configure your Mac to use Aunnop's key, ensure strict package naming, and build Version 2.

### â›”ï¸ 2.1. Safety Backup (Crucial)
Before touching your own config, back it up so you can restore your own project later.

1.  **Rename your existing key properties**:
    *   Go to `android/` folder.
    *   Rename `key.properties` to `key.properties.bak`.
2.  **Rename your existing google-services.json**:
    *   Go to `android/app/` folder.
    *   Rename `google-services.json` to `google-services.json.bak`.

### ðŸ“© 2.2. Receive & Place Files
1.  **Place the Keystore**:
    *   Take the `upload-keystore.jks` file Aunnop sent you.
    *   Put it inside your `android/app/` folder.
2.  **Create Key Properties**:
    *   Create a NEW file `android/key.properties`.
    *   Paste the following (Replace `AUNNOP_PASSWORD` with the real password he sent):
    
    ```properties
    storePassword=AUNNOP_PASSWORD
    keyPassword=AUNNOP_PASSWORD
    keyAlias=upload
    storeFile=../app/upload-keystore.jks
    ```

### ðŸ†” 2.3. Strict Constraints Check
You must verify these two items strictly.

1.  **Check Package Name**:
    *   Open `android/app/build.gradle.kts`.
    *   Ensure `applicationId` is exactly: `"com.Jobs4Dent.Jobs4Dent2"`.
    *   (Do not change it to anything else).

2.  **Check Version (Must be Version 2)**:
    *   Open `pubspec.yaml` (in the project root).
    *   Look for the `version:` line.
    *   It **MUST** be higher than Version 1 (which Aunnop already uploaded).
    *   **Recommended**:
        ```yaml
        version: 1.0.1+2
        ```
        *(The `+2` is the Version Code. This is the important part for Google Play).*

### ðŸ”¥ 2.4. Firebase Configuration
Since you are building for `com.Jobs4Dent.Jobs4Dent2`, you generally use the **existing** `google-services.json` if you are the one who created the project originally.

*   **Option A**: If you already have `google-services.json` for `com.Jobs4Dent.Jobs4Dent2`, just use it.
*   **Option B (Safest)**: 
    1.  Go to your Firebase Console.
    2.  Select the Android App with package `com.Jobs4Dent.Jobs4Dent2`.
    3.  Download the latest `google-services.json`.
    4.  Place it in `android/app/`.

### ðŸš€ 2.5. Build the AAB
Run the clean and build commands:

```bash
flutter clean
flutter pub get
flutter build appbundle --release
```

**Result**:
The file will be at: `build/app/outputs/bundle/release/app-release.aab`

### ðŸ“¤ 2.6. Send to Aunnop
Send this `app-release.aab` file back to Aunnop.

---

## ðŸ§¹ Part 3: Cleanup (Restore Your Environment)
**Immediately** after sending the file, revert your changes so you can work on your own tasks.

1.  **Delete Aunnop's Files**:
    *   Delete `android/app/upload-keystore.jks`.
    *   Delete `android/key.properties`.
2.  **Restore Your Files**:
    *   Rename `android/key.properties.bak` -> `android/key.properties`.
    *   Rename `android/app/google-services.json.bak` -> `android/app/google-services.json`.

---

## âš ï¸ Important Note for Aunnop (Upload Warning)

When Aunnop uploads this new AAB (Version 2) to Google Play Console:

**He might see an error:** *"Your Android App Bundle is signed with the wrong key."*

**Why?**
Because Version 1 was likely signed with a *different* key generated by Flutter or his machine previously.

**The Fix (Aunnop must do this):**
1.  Go to **Google Play Console** > **Release** > **Setup** > **App integrity**.
2.  Go to **App Signing**.
3.  Request a **Key Upgrade** or **Key Reset**.
4.  Follow Google's instructions to upload the certificate from the `upload-keystore.jks` he just generated (or simply use the Java command Google provides to register this new key).
